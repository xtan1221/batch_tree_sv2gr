package phylo.tree.reader;

import java.nio.file.Path;

public class TreeTest {
	static String fullNewickString="(a,((b,(c,d)),e));";
//	
//	static String fullNewickString2="(((((11647:0.00000000,(((11657:0.00000000,11757:0.00000000)0.7200:0.00002299,13133:0.00002299)0.3400:0.00000001,Gp0018209:0.00000000)1.0000:0.00000000)1.0000:0.00018366,13158:0.00000025)0.5200:0.00000593,((((13068:0.00000000,(13148:0.00000000,(Gp0018186:0.00000000,Gp0018212:0.00000000)1.0000:0.00000000)1.0000:0.00000000)1.0000:0.00024733,(13123:0.00003420,13153:0.00017270)0.9600:0.00028160)1.0000:0.00181785,(13143:0.00349614,3237:0.01542812)1.0000:0.00350464)1.0000:0.00047499,Gp0018183:0.00110287)1.0000:0.00037080)0.5300:0.00001705,((11652:0.00002299,(Gp0018189:0.00002299,Gp0018192:0.00002299)0.3500:0.00000000)0.4700:0.00000001,13128:0.00000000)0.6600:0.00001866)0.3900:0.00000432,Gp0018195:0.00000000,(((13138:0.00000000,Gp0018187:0.00000000)0.6700:0.00002298,(Gp0009978:0.00000000,Gp0018197:0.00000000)0.8600:0.00004598)0.3300:0.00000001,Gp0009948:0.00000000)0.2300:0.00000001);";
//	static String fullNewickString3="(((((((((((((((Gp0018192:0.00000000,Gp0018197:0.00000000)0.9300:0.00000000,Gp0018187:0.00000000)0.9300:0.00000000,Gp0009978:0.00000000)0.9300:0.00000000,13123:0.00000000)0.9300:0.00000000,11757:0.00000000)0.9300:0.00000000,11657:0.00000000)0.9300:0.00029813,Gp0018195:0.00000000)0.1400:0.00000001,(13133:0.00000000,(13138:0.00109395,Gp0009948:0.00000000)0.1400:0.00000009)0.0800:0.00000006)0.0400:0.00000001,(13068:0.00000000,(13158:0.00000000,(13143:0.00209024,Gp0018186:0.00000000)0.3700:0.00000018)0.1000:0.00000008)0.0800:0.00000006)0.0900:0.00000003,11647:0.00000000)0.1500:0.00000007,13148:0.00000000)0.2100:0.00000012,Gp0018183:0.00000000)0.4100:0.00000031,Gp0018212:0.00000000)0.4200:0.00001972,Gp0018209:0.00167122)0.4900:0.00007208,(13153:0.00059667,(13128:0.00000000,(11652:0.00009953,Gp0018189:0.00000000)0.6300:0.00000010)1.0000:0.00049701)1.0000:0.00109844,3237:0.00700932);";
	
	static String fullNewickString3="(11647:2.676E-5,((((((((((Gp0009978:0.0,(11652:0.0,(13128:3.602E-5,(13138:5.405E-5,Gp0018187:1.8E-5)0.816:1.801E-5)0.738:0.0)0.686:0.0)0.58:0.0,Gp0018189:0.0)0.588:1.0E-8,Gp0018197:0.0)0.626:1.802E-5,Gp0018192:1.8E-5)0.55:5.0E-8,11657:0.0)0.552:5.0E-8,11757:0.0)1.0:0.00169665,13143:0.00486975)1.0:0.00189374,((13068:0.0,(13148:0.0,(Gp0018183:0.0,(Gp0018186:0.0,Gp0018212:0.0)1.0:0.0)1.0:0.0)1.0:0.0)1.0:8.4211E-4,(13123:1.791E-5,13153:7.215E-5)1.0:2.291E-5)1.0:4.3604E-4)0.868:2.366E-5,(13158:0.0,(Gp0009948:0.0,Gp0018195:0.0)0.994:0.0)0.994:5.41E-6)0.996:6.664E-5,(13133:0.0,Gp0018209:1.804E-5)0.726:5.2E-7):2.676E-5);";
	static String newickString="";
//	static String fullNewickString="((raccoon:19.19959,bear:6.80041):0.84600[50],((sea_lion:11.99700, seal:12.00300):7.52973[100],((monkey:100.85930,cat:47.14069):20.59201[80], weasel:18.87953):2.09460[75]):3.87382[50],dog:25.46154);";
	
	static String sbNBSTree="(fungi_nbs1:0.68758799,(((sb_236:0.56517946,sb_260:0.37410977):0.24918825,sb_364:0.55306370):0.67407195,(sb_48:0.98014197,(((((sb_62:0.14625913,(sb_63:0.71222024,sb_310:0.29357678):0.01348226):0.08195594,sb_275:0.31914408):0.03434343,sb_361:0.39816849):0.33108492,sb_148:0.65570725):0.12208756,((((((((((((((sb_1:0.27236836,sb_72:0.26214378):0.12512521,sb_70:0.27961211):0.11787918,(((((sb_160:0.00000050,sb_269:0.00000050):0.01090305,sb_191:0.00139635):0.20841507,sb_327:0.16191450):0.03617402,(((sb_223:0.06735967,sb_333:0.07584496):0.02806337,(sb_229:0.04767672,sb_367:0.06881821):0.11526444):0.02209005,sb_359:0.14380991):0.08984888):0.06284209,sb_351:0.24354810):0.21650382):0.26971170,(((sb_2:0.16403021,sb_280:0.20512321):0.45910598,((((sb_7:0.28213905,sb_303:0.25826183):0.08320359,sb_172:0.28323344):0.08929448,(sb_52:0.09038336,sb_335:0.17535824):0.27389952):0.03150644,((sb_18:0.07179138,sb_257:0.06348158):0.23876564,((sb_116:0.12072054,sb_208:0.09887362):0.03981062,(sb_179:0.02489262,sb_187:0.07521707):0.11947149):0.17364352):0.05454659):0.23762858):0.04740686,(((sb_11:0.27125561,((sb_20:0.09332020,sb_100:0.07235087):0.09740070,sb_270:0.13116920):0.01525756):0.38313707,sb_176:0.68090316):0.04498170,((sb_34:0.36681884,sb_234:0.52454441):0.24609281,(sb_289:0.43853131,sb_297:0.37100077):0.14943765):0.07198330):0.03248300):0.01658991):0.01300934,((sb_5:0.71060407,sb_39:0.66573979):0.32511050,((((((((((sb_6:0.55106151,sb_262:0.30341246):0.18461980,(((sb_38:0.24985540,(sb_108:0.31217751,sb_321:0.25129364):0.03346563):0.00761372,(sb_122:0.32174613,sb_228:0.20769573):0.10070653):0.11980344,sb_106:0.39128337):0.05703951):0.03887836,sb_195:0.29577962):0.11702282,((((sb_27:0.39765483,sb_146:0.59229622):0.12195327,sb_368:0.52591000):0.03202725,((((sb_133:0.61538336,sb_159:0.47255473):0.03893278,sb_186:0.52831993):0.05899248,sb_220:0.68043701):0.06246085,sb_363:0.59351023):0.06835537):0.05473109,sb_188:0.57780156):0.02691808):0.09973286,(sb_258:0.25157396,sb_291:0.07739966):0.55573836):0.14881621,(sb_218:0.64457859,(sb_293:0.16418083,sb_343:0.40136147):0.34710616):0.31798831):0.24562084,((sb_16:0.70220726,sb_241:0.67860485):0.05856449,sb_29:0.90401708):0.11366291):0.02994030,((((((sb_8:0.26365990,sb_65:0.26711999):0.25793982,(((sb_125:0.25218450,(sb_184:0.00000000,sb_212:0.31251073):0.29775976):0.07994108,(sb_137:0.21035618,sb_226:0.24369372):0.10748570):0.08229442,sb_139:0.26309809):0.02840079):0.02494431,((sb_12:0.13106495,((sb_68:0.05862946,sb_286:0.12706557):0.02046399,(sb_98:0.02858006,sb_161:0.02363134):0.05476879):0.02792336):0.12176913,(sb_91:0.30040329,sb_117:0.23684973):0.11495783):0.13610929):0.11301843,(((sb_50:0.35443388,((sb_90:0.02744680,sb_283:0.00223961):0.16174698,sb_307:0.29313101):0.41059651):0.04697999,sb_129:0.45336317):0.03314928,sb_272:0.54762564):0.05305247):0.02667745,((sb_192:0.19820304,sb_246:0.23883890):0.09657337,sb_317:0.34416293):0.25870214):0.06921758,sb_41:0.67160132):0.04619186):0.04592211,((sb_45:0.30566174,sb_207:0.26640149):0.20580461,(sb_75:0.75738277,((sb_127:0.37560268,sb_337:0.54950103):0.19121292,sb_274:0.90811571):0.02356766):0.07156414):0.02765572):0.01259791,(((sb_9:0.59442682,sb_344:0.44283266):0.12738605,((sb_135:0.48591062,((sb_210:0.09709059,(sb_318:0.00743636,sb_360:0.01608209):0.07573116):0.13777891,sb_316:0.11695298):0.56723372):0.04376964,(sb_209:0.38491126,sb_292:0.49402573):0.44728997):0.04905800):0.05424929,(sb_40:1.09007785,(sb_95:0.46016503,sb_185:0.61101493):0.07033417):0.18714139):0.07182459):0.03175187):0.07216517):0.02152072,((((((sb_80:0.46707579,sb_82:0.35407223):0.09996875,((sb_97:0.17772047,sb_216:0.13137977):0.07144749,sb_114:0.28837360):0.30391097):0.07735518,(sb_253:0.49012993,sb_302:0.36438986):0.04462582):0.08807215,((sb_173:0.63968310,sb_362:0.44951091):0.10734002,(sb_326:0.45263239,sb_347:0.46970129):0.11011907):0.18912051):0.03580289,sb_140:0.56718970):0.02880124,(sb_99:0.19232510,sb_345:0.23018367):0.44309662):0.08771642):0.07528936,(sb_306:1.03312291,sb_353:1.13610809):0.05089922):0.03311454,(((((((((sb_37:0.03128911,sb_288:0.00125124):0.02032618,sb_355:0.00000000):0.05920272,sb_285:0.11829431):0.25112018,(((sb_217:0.01405759,sb_296:0.01451058):0.01084353,sb_311:0.01366494):0.01949972,sb_323:0.05968719):0.24246901):0.16893728,(sb_55:0.38762666,sb_144:0.35617628):0.13325728):0.03511491,sb_332:0.49550749):0.07159212,(sb_120:0.61792016,((sb_235:0.28265896,sb_282:0.25990541):0.41618549,sb_346:0.63840236):0.00485111):0.02651290):0.03378778,(sb_324:0.63690252,sb_356:0.69421727):0.05642076):0.08584372,sb_309:0.64469335):0.17017731):0.01543910,((sb_44:1.20879953,sb_237:0.87349002):0.17021652,sb_85:1.03003190):0.06029443):0.03468991,(sb_3:0.53750706,(sb_273:1.34329384,sb_290:0.57024158):0.20451357):0.12092280):0.05144002,sb_71:0.74915255):0.04225781,(((((((((sb_10:0.33178275,(sb_240:0.22518314,sb_271:0.20148120):0.05666306):0.07735892,sb_93:0.32903809):0.18155631,(sb_111:0.00000000,(sb_115:0.08767955,sb_221:0.00000000):0.09177639):0.76096053):0.07879697,sb_189:0.56979044):0.03864728,sb_163:0.55020346):0.00155144,((((sb_17:0.20681355,((sb_30:0.02606853,sb_94:0.04233102):0.03457011,sb_242:0.09984777):0.08540208):0.05890788,sb_215:0.17961184):0.10533264,sb_26:0.31160490):0.39370582,(((((sb_25:0.07673666,sb_87:0.05999429):0.04012696,sb_77:0.12726364):0.01060045,sb_88:0.10484191):0.03810198,sb_28:0.11779926):0.29532120,(sb_301:0.36667493,sb_313:0.44645293):0.04915008):0.09566504):0.07943483):0.05350684,(sb_201:1.62867626,sb_231:0.52273954):0.11410031):0.05162139,((((((((sb_31:0.00000050,sb_249:0.00000050):0.16371342,(sb_145:0.22707253,(sb_147:0.32993223,sb_320:0.33684219):0.03577163):0.12217696):0.17337761,(sb_84:0.27741674,(sb_312:0.00088289,sb_331:0.13245241):0.14746157):0.10064627):0.23897709,sb_205:0.31403487):0.15687370,(sb_203:0.39233400,sb_255:0.50030260):0.46110677):0.70115001,sb_138:1.30168691):0.21452470,sb_33:1.21526366):0.06475120,((sb_42:0.69197017,(sb_105:0.44566287,sb_206:0.34434731):0.31437299):0.19623727,(sb_277:0.74564782,sb_284:0.81969939):0.17983185):0.26458029):0.16943673):0.03068372,(((((sb_19:0.51118775,sb_126:0.47273378):0.10272093,sb_225:0.54302997):0.22057995,(sb_92:0.70839909,sb_305:0.75723624):0.12997111):0.06414412,((sb_118:0.40814380,sb_142:0.34174257):0.09648742,sb_130:0.82382448):0.50083927):0.27947771,sb_167:0.74357237):0.03048776):0.02111946):0.04056252,(((((((sb_13:0.41752567,(sb_101:0.39507825,sb_165:0.43798458):0.04756206):0.07312994,sb_14:0.81674801):0.15462353,sb_213:0.48624635):0.01776757,sb_56:0.57333921):0.05836151,((((sb_60:0.40339823,(sb_294:0.45550175,sb_336:0.23658684):0.15282216):0.04263493,sb_109:0.52068083):0.09398599,((sb_170:0.19963399,sb_247:0.19015776):0.03906747,sb_177:0.25001043):0.26372575):0.01592042,((sb_73:0.05195159,sb_267:0.03831445):0.32498406,sb_339:0.31584882):0.14267515):0.12981606):0.32400875,((((((sb_15:0.44702928,(sb_166:0.27686386,sb_200:0.38360436):0.17908134):0.01192332,sb_102:0.51890711):0.14651403,sb_214:0.72071135):0.03534440,(sb_149:0.74608971,sb_151:0.64023900):0.09532264):0.03621056,sb_57:0.84820533):0.39603102,(((sb_61:0.14090173,sb_295:0.20138566):0.09145961,sb_110:0.26168332):0.06637261,((sb_74:0.01703980,(sb_227:0.10784404,sb_268:0.00000000):0.04494384):0.38657950,(((sb_171:0.17002047,sb_248:0.18212080):0.02889092,sb_178:0.09227555):0.12403746,sb_340:0.23059137):0.08356138):0.03660817):0.26006524):0.01892013):0.17329412,(((sb_83:0.23814411,(sb_168:0.26129679,((sb_348:0.05945639,sb_350:0.05960630):0.05741168,sb_352:0.14114395):0.24298287):0.02314489):0.11742223,sb_204:0.38823306):0.06290849,(sb_89:0.27833075,sb_250:0.24888583):0.22559236):0.17477023):0.05500305):0.03731030,(((((sb_104:0.65458202,(sb_113:0.20735140,sb_300:0.17248413):0.40489129):0.03262072,sb_308:0.69930923):0.06982918,sb_123:1.08143051):0.09607602,((sb_238:0.47175883,sb_239:0.67414471):0.03889136,sb_244:0.68267468):0.24998219):0.04574532,((sb_190:0.66146252,sb_194:0.43023463):0.30015501,((sb_131:0.49809980,sb_304:0.67554523):0.03097988,((((((sb_23:0.23812052,sb_96:0.27217942):0.29221994,((sb_265:0.31755058,(sb_354:0.12047563,sb_358:0.15483385):0.11351318):0.13379393,sb_315:0.86497047):0.10383526):0.23885401,sb_162:0.55861483):0.09720166,(sb_121:0.34602491,sb_193:0.19570620):0.21903603):0.01417979,(sb_43:0.49345266,sb_153:0.38085026):0.11848927):0.05280782,((((((sb_24:0.29077883,sb_58:0.29193111):0.07167201,(sb_152:0.35150917,sb_198:0.36802832):0.01133159):0.02969666,((sb_51:0.46604953,sb_298:0.53583664):0.08134568,(((sb_78:0.12044639,sb_197:0.11810258):0.01457657,sb_254:0.10725350):0.26301963,sb_259:0.52111817):0.04070857):0.11005347):0.01323217,((sb_54:0.28780063,(sb_314:0.01320195,sb_322:0.02929523):0.30244304):0.07556325,sb_154:0.32113471):0.02758404):0.01669238,(sb_67:0.21648581,sb_278:0.26439580):0.14835874):0.04178607,((sb_329:0.39499470,(sb_330:0.17353422,sb_334:0.12628685):0.23219404):0.08738435,((((((sb_32:0.21664370,sb_36:1.30084837):0.12839625,sb_279:0.40231895):0.21629687,(sb_256:0.05192892,sb_328:0.05190071):0.34269872):0.04361195,(sb_136:0.73899773,sb_183:0.37610472):0.05362618):0.01567343,((((((((sb_46:0.21840643,(sb_53:0.22451859,sb_224:0.23259274):0.04439629):0.03748463,sb_180:0.25173204):0.01112689,sb_299:0.29739744):0.06417106,((sb_143:0.33394401,(sb_175:1.02451888,sb_245:0.49433029):0.09484678):0.00674330,sb_365:0.52082547):0.02296016):0.01359863,(((((sb_49:0.34558163,sb_264:0.39824579):0.03093422,sb_276:0.44041684):0.02270478,sb_128:0.36475117):0.04232725,(sb_76:0.45604138,(sb_182:0.20805965,sb_233:0.26645156):0.17124731):0.02057036):0.07542968,(((((sb_59:0.05524251,sb_119:0.03797961):0.01825728,(sb_64:0.00193219,sb_366:0.00615602):0.01237397):0.02452586,sb_281:0.09136218):0.04117094,((sb_211:0.01240747,sb_266:0.09752310):0.00617536,sb_319:0.03467606):0.08158271):0.22801914,(sb_243:0.12641561,sb_357:0.14993099):0.24658368):0.02761368):0.03670068):0.03264808,sb_86:0.41676922):0.05041439,(sb_103:0.40878872,sb_338:0.27490051):0.14154361):0.01345881,(sb_124:0.29578976,(sb_155:0.16411711,sb_156:0.13236260):0.08857329):0.13295190):0.01471062):0.01033396,(((sb_22:0.04306816,sb_232:0.12539889):0.39080805,sb_349:0.36668241):0.03520629,(((sb_66:0.30070189,(sb_157:0.40227745,sb_219:0.31644555):0.03225657):0.05583755,((sb_81:0.19829479,sb_325:0.23011148):0.04761391,sb_252:0.36716699):0.06261075):0.00460401,((sb_69:0.11307362,sb_202:0.11871491):0.37371757,sb_79:0.45355797):0.04455341):0.00567228):0.01224259):0.01027405):0.01196704):0.01399631):0.02508352):0.06941502):0.02669337):0.02046263):0.12710796):0.14269413):0.22317554):0.68758799);";
	
	static void testTree() {
		Tree tree = Tree.fromNewickString(sbNBSTree, NewickFileFormatType.SIMPLE_NEWICK_2);
		
		
		System.out.println(tree.toFullNewickString(NewickFileFormatType.SIMPLE_NEWICK_1));
	}
	
	static Path newickTreeFile=Path.of("C:\\Users\\tanxu\\Desktop\\scratch\\tmp_output\\1.nwk");
	
	static void rerootTreeTest() {
		
		Tree tree = Tree.fromNewickString(fullNewickString3, NewickFileFormatType.SIMPLE_NEWICK_2);
		
		Tree rerooted=tree.reroot("13143");
		
		System.out.println(rerooted.toFullNewickString(NewickFileFormatType.SIMPLE_NEWICK_2));
	}
	
	static void retrieveLeafLabels() {
		Tree tree = Tree.fromNewickString(newickString, NewickFileFormatType.SIMPLE_NEWICK_2);
		
		tree.getNodeIDMap().forEach((id,node)->{
			if(node.isLeaf()) {
				System.out.println(node.getLabel());
			}
		});
	}
	
	public static void main(String[] args) {
		testTree();
//		rerootTreeTest();
//		retrieveLeafLabels();
	}
	
}
